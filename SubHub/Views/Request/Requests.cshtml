@model IEnumerable<SubHub.Models.Request>

@{
    ViewBag.Title = "Requests";
}

<h2>Beiðnir</h2>

@using (Html.BeginForm("NewRequest", "Request", FormMethod.Get))
{
    <input type="submit" value="Senda inn beiðni" class="tfbutton get-text-button" />
}
<table class="table">
    <tr>
        
        <th>
            Stigagjöf
        </th>        
        <th>
            @Html.DisplayNameFor(model => model.Name)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.DateSubmitted)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Language)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Completed)
        </th>
        <th></th>
    </tr>
@{var requests = (from m in Model select m).ToList();
  foreach (var r in requests)
	{
		 var rating = r.RequestRating;
      <tr>
        <td>
            <a href="@Url.Action("Upvote", new { id = r.Id })" class="like-request"><span class="glyphicon glyphicon-arrow-up"></span></a>
            <span class="rating-count">@Html.DisplayFor( modelItem => rating.count)</span>
            
            <div hidden class="upvote-error-message">
                <p> Smelltu @Html.ActionLink("hér", "Login", "Account", routeValues: null, htmlAttributes: new { id = "loginLink" }) til að skrá þig inn.</p>
            </div>
        </td>
        @*<td>
            @Html.DisplayFor(modelItem => item.User.UserName)
        </td>*@
        <td>
            @Html.DisplayFor(modelItem => r.Name)
        </td>
        <td>
            @Html.DisplayFor(modelItem => r.DateSubmitted)
        </td>
        <td>
            @Html.DisplayFor(modelItem => r.Language.Language)
        </td>
        @if (r.Completed)
        {
            <td>
                Beiðni uppfyllt
            </td>
        }
        else
        {
            <td>
                @Html.ActionLink("Uppfylla beiðni", "Complete", "Request", new { id = r.Id }, new { @class = "complete-request" })
                <span class="glyphicon glyphicon-check"></span>
            </td>
        }
        
    </tr>
	}
}

</table>

<script src="~/Scripts/jquery-1.10.2.js"></script>
<script src="~/Scripts/RequestUpvoteScripts.js"></script>